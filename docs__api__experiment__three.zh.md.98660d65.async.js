"use strict";(self.webpackChunk_antv_l7_site=self.webpackChunk_antv_l7_site||[]).push([[4817],{96069:function(e,a,n){n.r(a);n(35164),n(43801),n(6974),n(27068),n(12520);var t=n(7808),r=(n(19480),n(64700),n(12318),n(99500)),l=n(13273),i=n(92379),s=n(25802),c=n(651);a.default=function(){return(0,c.jsx)(r.dY,{children:(0,c.jsx)(i.Suspense,{fallback:(0,c.jsx)(l.Z,{}),children:(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"markdown",children:[(0,c.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n h3 { color: #873bf4; border-bottom: 1px solid #f0f0f0; margin: 1.2em 0 0.4em; } p { margin: 0.6em 0; } h4 { border-bottom: 1px solid #f0f0f0; }h4::before { content: '> '; opacity: 0.5; } "}}),(0,c.jsxs)("h2",{id:"简介",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#简介",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"简介"]}),(0,c.jsx)("p",{children:s.texts[0].value}),(0,c.jsx)("p",{children:s.texts[1].value}),(0,c.jsx)("p",{children:s.texts[2].value}),(0,c.jsx)("p",{children:s.texts[3].value}),(0,c.jsx)("p",{children:s.texts[4].value}),(0,c.jsxs)("h2",{id:"使用",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#使用",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"使用"]}),(0,c.jsx)(t.Z,{lang:"javascript",children:s.texts[5].value}),(0,c.jsx)("p",{children:s.texts[6].value}),(0,c.jsxs)("h2",{id:"构造函数-new-threelayer",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#构造函数-new-threelayer",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"构造函数 new ThreeLayer"]}),(0,c.jsxs)("h3",{id:"onaddmeshes",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#onaddmeshes",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"onAddMeshes"]}),(0,c.jsx)("p",{children:s.texts[7].value}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:s.texts[8].value}),(0,c.jsx)("li",{children:s.texts[9].value})]}),(0,c.jsxs)("h2",{id:"threelayer",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#threelayer",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"ThreeLayer"]}),(0,c.jsx)("p",{children:s.texts[10].value}),(0,c.jsx)("p",{children:s.texts[11].value}),(0,c.jsxs)("h3",{id:"getmodelmatrixlnglat-altitude-rotation-scale-matrix",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#getmodelmatrixlnglat-altitude-rotation-scale-matrix",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"getModelMatrix(lnglat, altitude, rotation, scale): Matrix"]}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:s.texts[12].value}),(0,c.jsx)("li",{children:s.texts[13].value}),(0,c.jsx)("li",{children:s.texts[14].value}),(0,c.jsx)("li",{children:s.texts[15].value})]}),(0,c.jsx)("p",{children:s.texts[16].value}),(0,c.jsxs)("h3",{id:"applyobjectlnglatobject-lnglat-altibute-void",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#applyobjectlnglatobject-lnglat-altibute-void",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"applyObjectLngLat(object, lnglat, altibute): void"]}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:s.texts[17].value}),(0,c.jsx)("li",{children:s.texts[18].value}),(0,c.jsx)("li",{children:s.texts[19].value})]}),(0,c.jsx)("p",{children:s.texts[20].value}),(0,c.jsxs)("h3",{id:"setobjectlnglatobject-lnglat-altibute-void",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#setobjectlnglatobject-lnglat-altibute-void",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"setObjectLngLat(object, lnglat, altibute): void"]}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:s.texts[21].value}),(0,c.jsx)("li",{children:s.texts[22].value}),(0,c.jsx)("li",{children:s.texts[23].value})]}),(0,c.jsx)("p",{children:s.texts[24].value}),(0,c.jsxs)("h3",{id:"lnglattocoordlnglat-number-number",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#lnglattocoordlnglat-number-number",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"lnglatToCoord(lnglat): [number, number]"]}),(0,c.jsx)("ul",{children:(0,c.jsx)("li",{children:s.texts[25].value})}),(0,c.jsx)("p",{children:s.texts[26].value}),(0,c.jsxs)("h3",{id:"adjustmeshtomapobject-void",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#adjustmeshtomapobject-void",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"adjustMeshToMap(object): void"]}),(0,c.jsx)("ul",{children:(0,c.jsx)("li",{children:s.texts[27].value})}),(0,c.jsx)("p",{children:s.texts[28].value}),(0,c.jsx)("p",{children:s.texts[29].value}),(0,c.jsx)("p",{children:s.texts[30].value}),(0,c.jsxs)("h3",{id:"setmeshscaleobject-x-y-z-void",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#setmeshscaleobject-x-y-z-void",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"setMeshScale(object, x, y, z): void"]}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:s.texts[31].value}),(0,c.jsx)("li",{children:s.texts[32].value}),(0,c.jsx)("li",{children:s.texts[33].value}),(0,c.jsx)("li",{children:s.texts[34].value})]}),(0,c.jsx)("p",{children:s.texts[35].value}),(0,c.jsx)("p",{children:s.texts[36].value}),(0,c.jsx)("p",{children:s.texts[37].value}),(0,c.jsxs)("h3",{id:"addanimatemixermixer-void",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#addanimatemixermixer-void",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"addAnimateMixer(mixer): void"]}),(0,c.jsx)("ul",{children:(0,c.jsx)("li",{children:s.texts[38].value})}),(0,c.jsx)("p",{children:s.texts[39].value}),(0,c.jsxs)("h3",{id:"getrendercamera-threecamera",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#getrendercamera-threecamera",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"getRenderCamera(): THREE.Camera"]}),(0,c.jsx)("p",{children:s.texts[40].value}),(0,c.jsxs)("h2",{id:"加载模型",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#加载模型",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"加载模型"]}),(0,c.jsx)("p",{children:s.texts[41].value}),(0,c.jsxs)("h3",{id:"简单案例",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#简单案例",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"简单案例"]}),(0,c.jsx)("p",{children:s.texts[42].value}),(0,c.jsx)(t.Z,{lang:"javascript",children:s.texts[43].value})]})})})})}},53980:function(e,a,n){n.d(a,{G:function(){return h}});var t=n(97502),r=n(99500),l=(n(92379),"d8ttRdvsaeIwjsXPUrV3"),i="YWbojl5X0YI9jR8WQ6vF",s="nHrVcWv4dgQMNfb_O3dk",c="kLT5PvcX6twH_8KM1K4Y",d="HdNrro6Kmg0q9gTP4YLJ",o=n(651);var h=function(e){var a,n=e.isPlayground,h=e.exampleId,x=e.header,u=e.error;return(0,o.jsxs)("div",{className:l,children:[n?null:(0,o.jsx)("div",{className:i,children:x}),(0,o.jsxs)("div",{className:s,children:[(0,o.jsx)("div",{id:"playgroundScriptContainer_".concat(h),className:c}),u?(0,o.jsx)(t.ZP,{className:d,status:"error",title:(0,o.jsx)(r._H,{id:"演示代码报错，请检查"}),subTitle:(0,o.jsx)("pre",{children:(a=u,(a.reason?a.reason:a.message?a.message:a).toString())})}):null]})]})}},19298:function(e,a,n){n.d(a,{S:function(){return E}});var t=n(28633),r=n.n(t),l=n(5572),i=n(49377),s=n(23622),c=n(99500),d=n(35510),o=n(92379),h=n(4667),x=n(53980),u=n(8131),j=n(95913),p=n(32686),m=n(29318),v=n(52486),b=n(65879),I=n.n(b),g=n(72916),f=n(54014),y={},L=n(651),T=function(e){var a=e.title,n=e.relativePath,t=e.githubUrl,r=(0,c.WF)().themeConfig.relativePath;(0,f.KI)(),new(I())(location.href);return(0,L.jsx)(j.Z,{ghost:!1,title:a,subTitle:(0,L.jsx)(p.Z,{title:(0,L.jsx)(c._H,{id:"在 GitHub 上编辑"}),children:(0,L.jsx)("a",{href:function(e){var a=e.githubUrl,n=e.relativePath;e.prefix;return"".concat(a,"/edit/master/").concat(r,"/examples/").concat(n)}({githubUrl:t,relativePath:n,prefix:"examples"}),target:"_blank",rel:"noopener noreferrer",className:y.editOnGtiHubButton,children:(0,L.jsx)(u.Z,{})})}),extra:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(m.Z,{split:(0,L.jsx)(v.Z,{type:"vertical"})}),(0,L.jsx)(g.Z,{})]})})},w=n(24325),k=n.n(w),S=n(72725);function A(e,a,n,t){var r=function(e){var a=new Map;return(0,S.Z)(e,(function(e){(0,S.Z)(e.examples,(function(n){(0,S.Z)(n.demos,(function(t){a.set("".concat(e.id,"-").concat(n.id,"-").concat(t.id),k()(k()({},t),{},{relativePath:"".concat(e.id,"/").concat(n.id,"/demo/").concat(t.filename),targetExample:n,targetTopic:e}))}))}))})),a}(e);return r.get("".concat(a,"-").concat(n,"-").concat(t))}var E=function(e){var a=e.exampleTopics,n=e.topic,t=e.example,u=e.demo,j=e.size,p=e.replaceId,m=e.isPlayground,v=e.notFound,b=void 0===v?(0,L.jsx)(l.T,{}):v,I=A(a,n,t,u);if(!I)return b;var g=I.title,f=I.source,y=I.relativePath,w=(0,c.WF)().themeConfig,k=w.githubUrl,S=w.playground,E=(0,o.useState)(),M=r()(E,2),N=M[0],H=M[1],R=(0,o.useState)(!1),Z=r()(R,2),_=(Z[0],Z[1]),z=((0,c.bU)(),(0,L.jsx)(T,{title:(0,s.ic)(g),relativePath:y,githubUrl:k})),P="".concat(n,"_").concat(t,"_").concat(u);return(0,L.jsxs)(h.Z,{split:"vertical",defaultSize:"".concat(100*(1-j),"%"),minSize:100,children:[(0,L.jsx)(x.G,{exampleId:P,error:N,header:z,isPlayground:m}),(0,L.jsx)(i.p,{exampleId:P,source:f,relativePath:y,replaceId:p,onError:H,onFullscreen:_,onDestroy:d.Z,onReady:d.Z,playground:S})]})}},72916:function(e,a,n){var t=n(35957),r=(n(92379),n(48229)),l=n(651),i=function(){return(0,l.jsx)("img",{width:16,style:{margin:"5px"},src:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*iDSwRorar_QAAAAAAAAAAAAADmJ7AQ/original",alt:"react 组件库"})};a.Z=function(e){e.readingTime;return(0,l.jsxs)("div",{style:{float:"right",display:"flex",gap:"10px"},children:[(0,l.jsx)(r.Z,{href:"https://github.com/antvis/L7/issues/new","data-icon":"octicon-issue-opened","data-size":"large","data-show-count":"true","aria-label":"Issue antvis/l7 on GitHub",children:"反馈问题"}),(0,l.jsx)(r.Z,{href:"https://github.com/antvis/l7","data-icon":"octicon-star","data-size":"large","data-show-count":"true","aria-label":"Star antvis/l7 on GitHub",children:"关注项目"}),(0,l.jsx)(t.Z,{icon:(0,l.jsx)(i,{}),style:{fontWeight:600,height:"30px",padding:"1px 6px"},target:"blank",href:"https://larkmap.antv.antgroup.com/components/lark-map",children:"React 组件库"})]})}},54014:function(e,a,n){function t(){for(var e=window.location.pathname.replace("/docs/","/").replace("/zh/","/").split("/"),a=[],n=e.length;n>0;n--){var t=e.slice(0,n);a.push(t.join("/"))}return a}function r(){var e=window.location.pathname;e=(e=e.replace("/zh/","/")).replace("/docs","");var a=window.location.pathname.startsWith("/en")?/(\/[A-z]*\/?\/[A-z]*)\/?/:/(\/[A-z]*)\/?/;return e.match(a)[1]}function l(e){var a=[],n=e[0];for(a.push(n.key);n.children;)n=n.children[0],a.push(n.key);return a[a.length-1]}function i(e,a,n){return e.includes("/docs/")||e.includes("/zh/")?e.replace("/docs/","/").replace("/zh/","/"):n.every((function(a){var n="".concat(a).toLowerCase();return![n,"".concat(n,"/")].includes(e.toLowerCase())}))?a:e}n.d(a,{Gd:function(){return i},KI:function(){return r},Xd:function(){return t},iX:function(){return l}})},25802:function(e,a,n){n.r(a),n.d(a,{texts:function(){return t}});const t=[{value:"1、L7 支持允许用户接入第三方的渲染引擎对地图场景进行开发，threejs 作为当前最广泛使用的通用 3D 渲染引擎，L7 将其集成后可以满足\n用户自定义开发的需求，可以让 L7 覆盖更多的应用场景。",paraId:0,tocIndex:0},{value:"2、目前 L7Three 模块为了抹平不同地图底图之间的差异，提供了一些兼容方法，如 setMeshScale 方法，通过这些方法用户可以在不同的底图\n环境中使用同一套代码。",paraId:1,tocIndex:0},{value:"3、L7 提供的适配方法只负责 threejs 世界坐标到不同地图底图坐标的转化、 gl 上下文的共享以及渲染帧的同步，其余关于 3D 场景内容的搭建\n与普通 threejs 应用的开发没有任何区别。",paraId:2,tocIndex:0},{value:"4、L7 本身并没有集成 threejs，所以用于在使用 L7Three 模块的时候需要独立安装 threejs。",paraId:3,tocIndex:0},{value:"✨ 目前 L7 官方提供的 threejs 兼容是根据 0.115.0 版本进行开发的，使用其他版本 threejs 可能会存在兼容问题",paraId:4,tocIndex:0},{value:"// 1、引入对应模块\nimport { ThreeLayer, ThreeRender } from '@antv/l7-three';\nimport * as THREE from 'three';\n...\n// 2、注册服务\nscene.registerRenderService(ThreeRender);\n...\n// 3、构建 threejs 图层对象并在其中添加 threejs 构建的网格对象\nconst threeJSLayer = new ThreeLayer({\n  onAddMeshes: (threeScene: THREE.Scene, layer: ThreeLayer) => {\n    threeScene.add(new THREE.AmbientLight(0xffffff));\n\n    const sunlight = new THREE.DirectionalLight(0xffffff, 0.25);\n    sunlight.position.set(0, 80000000, 100000000);\n    sunlight.matrixWorldNeedsUpdate = true;\n    threeScene.add(sunlight);\n\n    let center = scene.getCenter();\n\n    let cubeGeometry = new THREE.BoxBufferGeometry(10000, 10000, 10000);\n    let cubeMaterial = new THREE.MeshNormalMaterial();\n    let cube = new THREE.Mesh(cubeGeometry, cubeMaterial);\n\n    layer.setObjectLngLat(cube, [center.lng + 0.05, center.lat], 0);\n    threeScene.add(cube);\n  },\n})\n.source(data)\n.animate(true);\n\n// 4、添加 threejs 图层对象\nscene.addLayer(threeJSLayer);\n\n",paraId:5,tocIndex:1},{value:"L7 将 threejs 的引用封装成一个特殊的图层对象，在使用上与其他的图层相同。",paraId:6,tocIndex:1},{value:"该方法接受两个参数 threeScene: THREE.Scene, layer: ThreeLayer",paraId:7,tocIndex:3},{value:"threeScene: 这是普通的 threejs 场景对象",paraId:8,tocIndex:3},{value:"layer: 这是 L7 提供的 threeLayer 对象，上面挂载了 threejs 空间适配到地图空间所需要的方法",paraId:8,tocIndex:3},{value:"用户新建的图层对象，同时也会在 onAddMesh 方法的第二个参数返回。",paraId:9,tocIndex:4},{value:"以下是挂载在 ThreeLayer 实例上的适配方法。",paraId:10,tocIndex:4},{value:"lnglat: [number, number] 经纬度",paraId:11,tocIndex:5},{value:"altitude: number = 0 相对高度",paraId:11,tocIndex:5},{value:"rotation: [number, number, number] = [0, 0, 0] 旋转角度",paraId:11,tocIndex:5},{value:"scale: [number, number, number] = [1, 1, 1] 缩放比例",paraId:11,tocIndex:5},{value:"用户可以通过该方法计算在对应经纬度点位、相对高度、旋转角度和缩放的模型矩阵\n该方法的返回值是 THREE.Matrix4 类型的矩阵",paraId:12,tocIndex:5},{value:"object: Object3D threejs 对象",paraId:13,tocIndex:6},{value:"lnglat: ILngLat[number, number] 经纬度",paraId:13,tocIndex:6},{value:"altitude = 0 相对高度",paraId:13,tocIndex:6},{value:"用户可以通过该方法将 object 对象从当前位置向指定位置移动（地图经纬度坐标）",paraId:14,tocIndex:6},{value:"object: Object3D threejs 对象",paraId:15,tocIndex:7},{value:"lnglat: ILngLat[number, number] 经纬度",paraId:15,tocIndex:7},{value:"altitude = 0 相对高度",paraId:15,tocIndex:7},{value:"用户可以通过该方法设置 object 对象的位置（地图经纬度坐标）",paraId:16,tocIndex:7},{value:"lnglat: ILngLat[number, number] 经纬度",paraId:17,tocIndex:8},{value:"用户可以通过该方法将经纬度坐标转化成 threejs 世界坐标",paraId:18,tocIndex:8},{value:"object: Object3D threejs 对象",paraId:19,tocIndex:9},{value:"用户在添加 threejs 对象的前可以通过该方法调整 3D 对象的姿态，保证添加对象能正确显示",paraId:20,tocIndex:9},{value:"✨ 在 threejs 世界坐标中，默认的上方向为 Y 轴正方向，而在地图坐标中，默认的上方向为 Z 轴正方向",paraId:21,tocIndex:9},{value:"✨ 用户不一定使用该方法调整物体的姿态，也可以自己实现",paraId:22,tocIndex:9},{value:"object: Object3D threejs 对象",paraId:23,tocIndex:10},{value:"x: number = 1 x 轴方向的缩放比例",paraId:23,tocIndex:10},{value:"y: number = 1 y 轴方向的缩放比例",paraId:23,tocIndex:10},{value:"z: number = 1 z 轴方向的缩放比例",paraId:23,tocIndex:10},{value:"用户可以通过该方法设置 threejs 对象缩放",paraId:24,tocIndex:10},{value:"✨ 其实通过设置 threejs 对象的 scale 属性一样能达到同样的效果，但是由于 mapbox 在计算模型矩阵的时候引入了特殊计算，所以无法直接设置 scale 属性进行缩放",paraId:25,tocIndex:10},{value:"✨ 同样的，可以直接修改 threejs 的 position、rotation 等调整 3D 对象的姿态",paraId:26,tocIndex:10},{value:"mixer: AnimationMixer threejs 的动画混合器",paraId:27,tocIndex:11},{value:"用户通过该方法管理加载模型的动画",paraId:28,tocIndex:11},{value:"返回根据当前地图场景参数下对应的 THREEJS 相机",paraId:29,tocIndex:12},{value:"用户可以使用 threejs 提供的能力加载其支持的任意模型",paraId:30,tocIndex:13},{value:"✨ 以加载 gltf 模型为例",paraId:31,tocIndex:14},{value:"// 1、引入加载器\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\n...\nconst threeJSLayer = new ThreeLayer({\n  onAddMeshes: (threeScene: THREE.Scene, layer: ThreeLayer) => {\n    ...\n    // 2、构建加载器\n    const loader = new GLTFLoader();\n    // 3、加载模型\n    loader.load('https://gw.alipayobjects.com/os/bmw-prod/3ca0a546-92d8-4ba0-a89c-017c218d5bea.gltf',\n    (gltf) => {\n      const model = gltf.scene;\n      layer.adjustMeshToMap(model);\n      layer.setMeshScale(model, 1000, 1000, 1000);\n      layer.setObjectLngLat( model, [center.lng, center.lat], 0 );\n\n      // 4、播放模型上绑定的动画\n      const animations = gltf.animations;\n      if (animations && animations.length) {\n        const mixer = new THREE.AnimationMixer(model);\n        const animation = animations[2];\n        const action = mixer.clipAction(animation);\n        action.play();\n        // 5、由 L7 控制模型动画的播放\n        layer.addAnimateMixer(mixer);\n      }\n    })\n  }\n}).source(data)\n.animate(true) // 若需要播放模型动画，请开启动画模式（或者场景中已经存在开启动画的图层）\n\n",paraId:32,tocIndex:14}]}}]);