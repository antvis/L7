"use strict";(self.webpackChunk_antv_l7_site=self.webpackChunk_antv_l7_site||[]).push([[5185],{52495:function(e,t,a){a.r(t);a(35164),a(43801),a(6974),a(27068),a(12520);var n=a(7808),r=(a(19480),a(64700),a(12318),a(99500)),i=a(13273),s=a(92379),o=a(29741),l=a(651);t.default=function(){return(0,l.jsx)(r.dY,{children:(0,l.jsx)(s.Suspense,{fallback:(0,l.jsx)(i.Z,{}),children:(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"markdown",children:[(0,l.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n h3 { color: #873bf4; border-bottom: 1px solid #f0f0f0; margin: 1.2em 0 0.4em; } p { margin: 0.6em 0; } h4 { border-bottom: 1px solid #f0f0f0; }h4::before { content: '> '; opacity: 0.5; } "}}),(0,l.jsxs)("h2",{id:"introduction",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#introduction",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"Introduction"]}),(0,l.jsx)("p",{children:o.texts[0].value}),(0,l.jsx)("p",{children:o.texts[1].value}),(0,l.jsx)("p",{children:o.texts[2].value}),(0,l.jsx)("p",{children:o.texts[3].value}),(0,l.jsx)("p",{children:o.texts[4].value}),(0,l.jsxs)("h2",{id:"use",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#use",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"use"]}),(0,l.jsx)(n.Z,{lang:"javascript",children:o.texts[5].value}),(0,l.jsx)("p",{children:o.texts[6].value}),(0,l.jsxs)("h2",{id:"constructor-new-threelayer",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#constructor-new-threelayer",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"Constructor new ThreeLayer"]}),(0,l.jsxs)("h3",{id:"onaddmeshes",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#onaddmeshes",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"onAddMeshes"]}),(0,l.jsx)("p",{children:o.texts[7].value}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:o.texts[8].value}),(0,l.jsx)("li",{children:o.texts[9].value})]}),(0,l.jsxs)("h2",{id:"threelayer",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#threelayer",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"ThreeLayer"]}),(0,l.jsx)("p",{children:o.texts[10].value}),(0,l.jsx)("p",{children:o.texts[11].value}),(0,l.jsxs)("h3",{id:"getmodelmatrixlnglat-altitude-rotation-scale-matrix",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#getmodelmatrixlnglat-altitude-rotation-scale-matrix",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"getModelMatrix(lnglat, altitude, rotation, scale): Matrix"]}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:o.texts[12].value}),(0,l.jsx)("li",{children:o.texts[13].value}),(0,l.jsx)("li",{children:o.texts[14].value}),(0,l.jsx)("li",{children:o.texts[15].value})]}),(0,l.jsx)("p",{children:o.texts[16].value}),(0,l.jsxs)("h3",{id:"applyobjectlnglatobject-lnglat-altibute-void",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#applyobjectlnglatobject-lnglat-altibute-void",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"applyObjectLngLat(object, lnglat, altibute): void"]}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:o.texts[17].value}),(0,l.jsx)("li",{children:o.texts[18].value}),(0,l.jsx)("li",{children:o.texts[19].value})]}),(0,l.jsx)("p",{children:o.texts[20].value}),(0,l.jsxs)("h3",{id:"setobjectlnglatobject-lnglat-altibute-void",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#setobjectlnglatobject-lnglat-altibute-void",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"setObjectLngLat(object, lnglat, altibute): void"]}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:o.texts[21].value}),(0,l.jsx)("li",{children:o.texts[22].value}),(0,l.jsx)("li",{children:o.texts[23].value})]}),(0,l.jsx)("p",{children:o.texts[24].value}),(0,l.jsxs)("h3",{id:"lnglattocoordlnglat-number-number",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#lnglattocoordlnglat-number-number",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"lnglatToCoord(lnglat): [number, number]"]}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:o.texts[25].value})}),(0,l.jsx)("p",{children:o.texts[26].value}),(0,l.jsxs)("h3",{id:"adjustmeshtomapobject-void",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#adjustmeshtomapobject-void",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"adjustMeshToMap(object): void"]}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:o.texts[27].value})}),(0,l.jsx)("p",{children:o.texts[28].value}),(0,l.jsx)("p",{children:o.texts[29].value}),(0,l.jsx)("p",{children:o.texts[30].value}),(0,l.jsxs)("h3",{id:"setmeshscaleobject-x-y-z-void",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#setmeshscaleobject-x-y-z-void",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"setMeshScale(object, x, y, z): void"]}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:o.texts[31].value}),(0,l.jsx)("li",{children:o.texts[32].value}),(0,l.jsx)("li",{children:o.texts[33].value}),(0,l.jsx)("li",{children:o.texts[34].value})]}),(0,l.jsx)("p",{children:o.texts[35].value}),(0,l.jsx)("p",{children:o.texts[36].value}),(0,l.jsx)("p",{children:o.texts[37].value}),(0,l.jsxs)("h3",{id:"addanimatemixermixer-void",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#addanimatemixermixer-void",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"addAnimateMixer(mixer): void"]}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:o.texts[38].value})}),(0,l.jsx)("p",{children:o.texts[39].value}),(0,l.jsxs)("h3",{id:"getrendercamera-threecamera",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#getrendercamera-threecamera",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"getRenderCamera(): THREE.Camera"]}),(0,l.jsx)("p",{children:o.texts[40].value}),(0,l.jsxs)("h2",{id:"load-model",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#load-model",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"Load model"]}),(0,l.jsx)("p",{children:o.texts[41].value}),(0,l.jsxs)("h3",{id:"simple-case",children:[(0,l.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#simple-case",children:(0,l.jsx)("span",{className:"icon icon-link"})}),"Simple case"]}),(0,l.jsx)("p",{children:o.texts[42].value}),(0,l.jsx)(n.Z,{lang:"javascript",children:o.texts[43].value})]})})})})}},53980:function(e,t,a){a.d(t,{G:function(){return h}});var n=a(97502),r=a(99500),i=(a(92379),"d8ttRdvsaeIwjsXPUrV3"),s="YWbojl5X0YI9jR8WQ6vF",o="nHrVcWv4dgQMNfb_O3dk",l="kLT5PvcX6twH_8KM1K4Y",d="HdNrro6Kmg0q9gTP4YLJ",c=a(651);var h=function(e){var t,a=e.isPlayground,h=e.exampleId,u=e.header,x=e.error;return(0,c.jsxs)("div",{className:i,children:[a?null:(0,c.jsx)("div",{className:s,children:u}),(0,c.jsxs)("div",{className:o,children:[(0,c.jsx)("div",{id:"playgroundScriptContainer_".concat(h),className:l}),x?(0,c.jsx)(n.ZP,{className:d,status:"error",title:(0,c.jsx)(r._H,{id:"演示代码报错，请检查"}),subTitle:(0,c.jsx)("pre",{children:(t=x,(t.reason?t.reason:t.message?t.message:t).toString())})}):null]})]})}},19298:function(e,t,a){a.d(t,{S:function(){return E}});var n=a(28633),r=a.n(n),i=a(5572),s=a(49377),o=a(23622),l=a(99500),d=a(35510),c=a(92379),h=a(4667),u=a(53980),x=a(8131),m=a(95913),p=a(32686),j=a(29318),v=a(52486),b=a(65879),g=a.n(b),f=a(72916),I=a(54014),y={},T=a(651),L=function(e){var t=e.title,a=e.relativePath,n=e.githubUrl,r=(0,l.WF)().themeConfig.relativePath;(0,I.KI)(),new(g())(location.href);return(0,T.jsx)(m.Z,{ghost:!1,title:t,subTitle:(0,T.jsx)(p.Z,{title:(0,T.jsx)(l._H,{id:"在 GitHub 上编辑"}),children:(0,T.jsx)("a",{href:function(e){var t=e.githubUrl,a=e.relativePath;e.prefix;return"".concat(t,"/edit/master/").concat(r,"/examples/").concat(a)}({githubUrl:n,relativePath:a,prefix:"examples"}),target:"_blank",rel:"noopener noreferrer",className:y.editOnGtiHubButton,children:(0,T.jsx)(x.Z,{})})}),extra:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(j.Z,{split:(0,T.jsx)(v.Z,{type:"vertical"})}),(0,T.jsx)(f.Z,{})]})})},w=a(24325),S=a.n(w),k=a(72725);function A(e,t,a,n){var r=function(e){var t=new Map;return(0,k.Z)(e,(function(e){(0,k.Z)(e.examples,(function(a){(0,k.Z)(a.demos,(function(n){t.set("".concat(e.id,"-").concat(a.id,"-").concat(n.id),S()(S()({},n),{},{relativePath:"".concat(e.id,"/").concat(a.id,"/demo/").concat(n.filename),targetExample:a,targetTopic:e}))}))}))})),t}(e);return r.get("".concat(t,"-").concat(a,"-").concat(n))}var E=function(e){var t=e.exampleTopics,a=e.topic,n=e.example,x=e.demo,m=e.size,p=e.replaceId,j=e.isPlayground,v=e.notFound,b=void 0===v?(0,T.jsx)(i.T,{}):v,g=A(t,a,n,x);if(!g)return b;var f=g.title,I=g.source,y=g.relativePath,w=(0,l.WF)().themeConfig,S=w.githubUrl,k=w.playground,E=(0,c.useState)(),M=r()(E,2),N=M[0],H=M[1],R=(0,c.useState)(!1),Z=r()(R,2),z=(Z[0],Z[1]),_=((0,l.bU)(),(0,T.jsx)(L,{title:(0,o.ic)(f),relativePath:y,githubUrl:S})),P="".concat(a,"_").concat(n,"_").concat(x);return(0,T.jsxs)(h.Z,{split:"vertical",defaultSize:"".concat(100*(1-m),"%"),minSize:100,children:[(0,T.jsx)(u.G,{exampleId:P,error:N,header:_,isPlayground:j}),(0,T.jsx)(s.p,{exampleId:P,source:I,relativePath:y,replaceId:p,onError:H,onFullscreen:z,onDestroy:d.Z,onReady:d.Z,playground:k})]})}},72916:function(e,t,a){var n=a(35957),r=(a(92379),a(48229)),i=a(651),s=function(){return(0,i.jsx)("img",{width:16,style:{margin:"5px"},src:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*iDSwRorar_QAAAAAAAAAAAAADmJ7AQ/original",alt:"react 组件库"})};t.Z=function(e){e.readingTime;return(0,i.jsxs)("div",{style:{float:"right",display:"flex",gap:"10px"},children:[(0,i.jsx)(r.Z,{href:"https://github.com/antvis/L7/issues/new","data-icon":"octicon-issue-opened","data-size":"large","data-show-count":"true","aria-label":"Issue antvis/l7 on GitHub",children:"反馈问题"}),(0,i.jsx)(r.Z,{href:"https://github.com/antvis/l7","data-icon":"octicon-star","data-size":"large","data-show-count":"true","aria-label":"Star antvis/l7 on GitHub",children:"关注项目"}),(0,i.jsx)(n.Z,{icon:(0,i.jsx)(s,{}),style:{fontWeight:600,height:"30px",padding:"1px 6px"},target:"blank",href:"https://larkmap.antv.antgroup.com/components/lark-map",children:"React 组件库"})]})}},54014:function(e,t,a){function n(){for(var e=window.location.pathname.replace("/docs/","/").replace("/zh/","/").split("/"),t=[],a=e.length;a>0;a--){var n=e.slice(0,a);t.push(n.join("/"))}return t}function r(){var e=window.location.pathname;e=(e=e.replace("/zh/","/")).replace("/docs","");var t=window.location.pathname.startsWith("/en")?/(\/[A-z]*\/?\/[A-z]*)\/?/:/(\/[A-z]*)\/?/;return e.match(t)[1]}function i(e){var t=[],a=e[0];for(t.push(a.key);a.children;)a=a.children[0],t.push(a.key);return t[t.length-1]}function s(e,t,a){return e.includes("/docs/")||e.includes("/zh/")?e.replace("/docs/","/").replace("/zh/","/"):a.every((function(t){var a="".concat(t).toLowerCase();return![a,"".concat(a,"/")].includes(e.toLowerCase())}))?t:e}a.d(t,{Gd:function(){return s},KI:function(){return r},Xd:function(){return n},iX:function(){return i}})},29741:function(e,t,a){a.r(t),a.d(t,{texts:function(){return n}});const n=[{value:"1. L7 supports allowing users to access third-party rendering engines to develop map scenes. ThreeJS is currently the most widely used general-purpose 3D rendering engine. L7 can meet the requirements after integrating it.\nUser-defined development needs allow L7 to cover more application scenarios.",paraId:0,tocIndex:0},{value:"2. Currently, in order to smooth out the differences between different map basemaps, the L7Three module provides some compatibility methods, such as the setMeshScale method. Through these methods, users can\nenvironment using the same set of code.",paraId:1,tocIndex:0},{value:"3. The adaptation method provided by L7 is only responsible for the conversion of threejs world coordinates to different map basemap coordinates, the sharing of gl context and the synchronization of rendering frames. The rest is related to the construction of 3D scene content.\nThere is no difference from the development of ordinary threejs applications.",paraId:2,tocIndex:0},{value:"4. L7 itself does not integrate threejs, so you need to install threejs independently when using the L7Three module.",paraId:3,tocIndex:0},{value:"✨ Currently, the threejs compatibility officially provided by L7 is developed based on version 0.115.0. There may be compatibility issues when using other versions of threejs.",paraId:4,tocIndex:0},{value:"// 1. Introduce the corresponding module\nimport { ThreeLayer, ThreeRender } from '@antv/l7-three';\nimport * as THREE from 'three';\n...\n// 2. Registration service\nscene.registerRenderService(ThreeRender);\n...\n// 3. Build the threejs layer object and add the grid object built by threejs to it.\nconst threeJSLayer = new ThreeLayer({\n  onAddMeshes: (threeScene: THREE.Scene, layer: ThreeLayer) => {\n    threeScene.add(new THREE.AmbientLight(0xffffff));\n\n    const sunlight = new THREE.DirectionalLight(0xffffff, 0.25);\n    sunlight.position.set(0, 80000000, 100000000);\n    sunlight.matrixWorldNeedsUpdate = true;\n    threeScene.add(sunlight);\n\n    let center = scene.getCenter();\n\n    let cubeGeometry = new THREE.BoxBufferGeometry(10000, 10000, 10000);\n    let cubeMaterial = new THREE.MeshNormalMaterial();\n    let cube = new THREE.Mesh(cubeGeometry, cubeMaterial);\n\n    layer.setObjectLngLat(cube, [center.lng + 0.05, center.lat], 0);\n    threeScene.add(cube);\n  },\n})\n.source(data)\n.animate(true);\n\n// 4. Add threejs layer object\nscene.addLayer(threeJSLayer);\n",paraId:5,tocIndex:1},{value:"L7 encapsulates the reference of threejs into a special layer object, which is used the same as other layers.",paraId:6,tocIndex:1},{value:"This method accepts two parameters threeScene: THREE.Scene, layer: ThreeLayer",paraId:7,tocIndex:3},{value:"threeScene: This is a normal threejs scene object",paraId:8,tocIndex:3},{value:"layer: This is the threeLayer object provided by L7, which mounts the methods needed to adapt the threejs space to the map space.",paraId:8,tocIndex:3},{value:"The layer object created by the user will also be returned in the second parameter of the onAddMesh method.",paraId:9,tocIndex:4},{value:"The following is the adaptation method mounted on the ThreeLayer instance.",paraId:10,tocIndex:4},{value:"lnglat: [number, number] latitude and longitude",paraId:11,tocIndex:5},{value:"altitude: number = 0 relative altitude",paraId:11,tocIndex:5},{value:"rotation: [number, number, number] = [0, 0, 0] rotation angle",paraId:11,tocIndex:5},{value:"scale: [number, number, number] = [1, 1, 1] scaling",paraId:11,tocIndex:5},{value:"Users can use this method to calculate the model matrix at the corresponding longitude and latitude point, relative height, rotation angle and scaling.\nThe return value of this method is a matrix of type THREE.Matrix4",paraId:12,tocIndex:5},{value:"object: Object3D threejs object",paraId:13,tocIndex:6},{value:"lnglat: ILngLat[number, number] latitude and longitude",paraId:13,tocIndex:6},{value:"altitude = 0 relative altitude",paraId:13,tocIndex:6},{value:"The user can use this method to move the object object from the current location to the specified location (map longitude and latitude coordinates)",paraId:14,tocIndex:6},{value:"object: Object3D threejs object",paraId:15,tocIndex:7},{value:"lnglat: ILngLat[number, number] latitude and longitude",paraId:15,tocIndex:7},{value:"altitude = 0 relative altitude",paraId:15,tocIndex:7},{value:"The user can set the location of the object object (map longitude and latitude coordinates) through this method",paraId:16,tocIndex:7},{value:"lnglat: ILngLat[number, number] latitude and longitude",paraId:17,tocIndex:8},{value:"Users can use this method to convert latitude and longitude coordinates into threejs world coordinates",paraId:18,tocIndex:8},{value:"object: Object3D threejs object",paraId:19,tocIndex:9},{value:"Users can use this method to adjust the posture of the 3D object before adding the threejs object to ensure that the added object can be displayed correctly.",paraId:20,tocIndex:9},{value:"✨ In threejs world coordinates, the default upward direction is the positive Y-axis direction, while in map coordinates, the default upward direction is the positive Z-axis direction.",paraId:21,tocIndex:9},{value:"✨ Users do not necessarily use this method to adjust the posture of objects, they can also implement it themselves",paraId:22,tocIndex:9},{value:"object: Object3D threejs object",paraId:23,tocIndex:10},{value:"x: number = 1 Scaling ratio in x-axis direction",paraId:23,tocIndex:10},{value:"y: number = 1 Scaling ratio in the y-axis direction",paraId:23,tocIndex:10},{value:"z: number = 1 Scaling ratio in z-axis direction",paraId:23,tocIndex:10},{value:"Users can set the threejs object zoom through this method",paraId:24,tocIndex:10},{value:"✨ In fact, the same effect can be achieved by setting the scale attribute of the threejs object. However, because mapbox introduces special calculations when calculating the model matrix, it cannot directly set the scale attribute for scaling.",paraId:25,tocIndex:10},{value:"✨ Similarly, you can directly modify the position, rotation, etc. of threejs to adjust the posture of the 3D object.",paraId:26,tocIndex:10},{value:"mixer: AnimationMixer animation mixer for threejs",paraId:27,tocIndex:11},{value:"The user manages the animation of loading the model through this method.",paraId:28,tocIndex:11},{value:"Returns the corresponding THREEJS camera based on the current map scene parameters.",paraId:29,tocIndex:12},{value:"Users can use the capabilities provided by threejs to load any model it supports.",paraId:30,tocIndex:13},{value:"✨ Take loading gltf model as an example",paraId:31,tocIndex:14},{value:"// 1. Introduce loader\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\n...\nconst threeJSLayer = new ThreeLayer({\n  onAddMeshes: (threeScene: THREE.Scene, layer: ThreeLayer) => {\n    ...\n    // 2. Build the loader\n    const loader = new GLTFLoader();\n    // 3. Load model\n    loader.load('https://gw.alipayobjects.com/os/bmw-prod/3ca0a546-92d8-4ba0-a89c-017c218d5bea.gltf',\n    (gltf) => {\n      const model = gltf.scene;\n      layer.adjustMeshToMap(model);\n      layer.setMeshScale(model, 1000, 1000, 1000);\n      layer.setObjectLngLat( model, [center.lng, center.lat], 0 );\n\n      // 4. Play the animation bound to the model\n      const animations = gltf.animations;\n      if (animations && animations.length) {\n        const mixer = new THREE.AnimationMixer(model);\n        const animation = animations[2];\n        const action = mixer.clipAction(animation);\n        action.play();\n        // 5. L7 controls the playback of model animation\n        layer.addAnimateMixer(mixer);\n      }\n    })\n  }\n}).source(data)\n.animate(true) // If you need to play model animation, please turn on the animation mode (or there is already a layer with animation turned on in the scene)\n",paraId:32,tocIndex:14}]}}]);