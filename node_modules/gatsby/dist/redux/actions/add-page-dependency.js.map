{"version":3,"sources":["../../../src/redux/actions/add-page-dependency.js"],"names":["store","require","actions","createPageDependency","path","nodeId","connection","state","getState","nodeDependencyExists","connectionDependencyExists","componentDataDependencies","nodes","has","get","connections","action","dispatch","module","exports"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAYC,OAAO,CAAE,KAAF,CAAzB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAcD,OAAO,CAAE,eAAF,CAA3B;;AAEA,SAASE,oBAAT,CAA8B;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,MAAR;AAAgBC,EAAAA;AAAhB,CAA9B,EAA4D;AAC1D,QAAMC,KAAK,GAAGP,KAAK,CAACQ,QAAN,EAAd,CAD0D,CAG1D;AACA;;AACA,MAAIC,oBAAoB,GAAG,KAA3B;AACA,MAAIC,0BAA0B,GAAG,KAAjC;;AACA,MAAI,CAACL,MAAL,EAAa;AACXI,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MACEJ,MAAM,IACNE,KAAK,CAACI,yBAAN,CAAgCC,KAAhC,CAAsCC,GAAtC,CAA0CR,MAA1C,CADA,IAEAE,KAAK,CAACI,yBAAN,CAAgCC,KAAhC,CAAsCE,GAAtC,CAA0CT,MAA1C,EAAkDQ,GAAlD,CAAsDT,IAAtD,CAHF,EAIE;AACAK,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MAAI,CAACH,UAAL,EAAiB;AACfI,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MACEJ,UAAU,IACVC,KAAK,CAACI,yBAAN,CAAgCI,WAAhC,CAA4CF,GAA5C,CAAgDP,UAAhD,CADA,IAEAC,KAAK,CAACI,yBAAN,CAAgCI,WAAhC,CAA4CD,GAA5C,CAAgDR,UAAhD,EAA4DO,GAA5D,CAAgET,IAAhE,CAHF,EAIE;AACAM,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MAAID,oBAAoB,IAAIC,0BAA5B,EAAwD;AACtD;AACD,GA7ByD,CA+B1D;;;AACA,QAAMM,MAAM,GAAGd,OAAO,CAACC,oBAAR,CAA6B;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,MAAR;AAAgBC,IAAAA;AAAhB,GAA7B,CAAf;AACAN,EAAAA,KAAK,CAACiB,QAAN,CAAeD,MAAf;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiBhB,oBAAjB","sourcesContent":["const { store } = require(`../`)\nconst { actions } = require(`./internal.js`)\n\nfunction createPageDependency({ path, nodeId, connection }) {\n  const state = store.getState()\n\n  // Check that the dependencies aren't already recorded so we\n  // can avoid creating lots of very noisy actions.\n  let nodeDependencyExists = false\n  let connectionDependencyExists = false\n  if (!nodeId) {\n    nodeDependencyExists = true\n  }\n  if (\n    nodeId &&\n    state.componentDataDependencies.nodes.has(nodeId) &&\n    state.componentDataDependencies.nodes.get(nodeId).has(path)\n  ) {\n    nodeDependencyExists = true\n  }\n  if (!connection) {\n    connectionDependencyExists = true\n  }\n  if (\n    connection &&\n    state.componentDataDependencies.connections.has(connection) &&\n    state.componentDataDependencies.connections.get(connection).has(path)\n  ) {\n    connectionDependencyExists = true\n  }\n  if (nodeDependencyExists && connectionDependencyExists) {\n    return\n  }\n\n  // It's new, let's dispatch it\n  const action = actions.createPageDependency({ path, nodeId, connection })\n  store.dispatch(action)\n}\n\nmodule.exports = createPageDependency\n"],"file":"add-page-dependency.js"}