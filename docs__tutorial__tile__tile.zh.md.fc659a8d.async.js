"use strict";(self.webpackChunk_antv_l7_site=self.webpackChunk_antv_l7_site||[]).push([[4259],{14883:function(e,n,a){a.r(n);a(35164),a(43801),a(6974),a(27068),a(33574);var t=a(7808),s=(a(19480),a(97595),a(22593),a(99500)),r=a(13273),o=a(92379),l=a(52142),c=a(651);n.default=function(){return(0,c.jsx)(s.dY,{children:(0,c.jsx)(o.Suspense,{fallback:(0,c.jsx)(r.Z,{}),children:(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"markdown",children:[(0,c.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n h3 { color: #873bf4; border-bottom: 1px solid #f0f0f0; margin: 1.2em 0 0.4em; } p { margin: 0.6em 0; } h4 { border-bottom: 1px solid #f0f0f0; }h4::before { content: '> '; opacity: 0.5; } "}}),(0,c.jsx)("p",{children:l.texts[0].value}),(0,c.jsxs)("h3",{id:"option",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#option",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"option"]}),(0,c.jsxs)("p",{children:[l.texts[1].value,(0,c.jsx)("code",{children:l.texts[2].value}),l.texts[3].value]}),(0,c.jsxs)("ul",{children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("code",{children:l.texts[4].value}),l.texts[5].value,(0,c.jsx)("ul",{children:(0,c.jsx)("li",{children:l.texts[6].value})})]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("code",{children:l.texts[7].value}),l.texts[8].value,(0,c.jsx)("ul",{children:(0,c.jsx)("li",{children:l.texts[9].value})})]})]}),(0,c.jsx)(t.Z,{lang:"javascript",children:l.texts[10].value}),(0,c.jsxs)("h4",{id:"mask",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#mask",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"Mask"]}),(0,c.jsxs)("p",{children:[l.texts[11].value,(0,c.jsx)("code",{children:l.texts[12].value}),l.texts[13].value,(0,c.jsx)("code",{children:l.texts[14].value}),l.texts[15].value]}),(0,c.jsx)(t.Z,{lang:"js",children:l.texts[16].value}),(0,c.jsxs)("h3",{id:"source",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#source",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"source"]}),(0,c.jsxs)("p",{children:[l.texts[17].value,(0,c.jsx)("code",{children:l.texts[18].value}),l.texts[19].value,(0,c.jsx)("code",{children:l.texts[20].value}),l.texts[21].value]}),(0,c.jsx)("img",{width:"80%",style:{display:"block",margin:"0 auto"},alt:"案例",src:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*cMFMTqF7WoIAAAAAAAAAAAAAARQnAQ"}),(0,c.jsx)(t.Z,{lang:"javascript",children:l.texts[22].value}),(0,c.jsxs)("h3",{id:"event",children:[(0,c.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#event",children:(0,c.jsx)("span",{className:"icon icon-link"})}),"event"]}),(0,c.jsx)("p",{children:l.texts[23].value}),(0,c.jsx)(t.Z,{lang:"javascript",children:l.texts[24].value})]})})})})}},23832:function(e,n,a){a.d(n,{T:function(){return t.T}});var t=a(87575)},90779:function(e,n,a){a.d(n,{p:function(){return t.p}});var t=a(25441)},41102:function(e,n,a){a.d(n,{G:function(){return t.G}});var t=a(4481)},3088:function(e,n,a){a.d(n,{S:function(){return t.S}});var t=a(74284)},52142:function(e,n,a){a.r(n),a.d(n,{texts:function(){return t}});const t=[{value:"瓦片图层相比于普通的图层而言，在使用上有许多需要注意的地方。",paraId:0},{value:"在初始化瓦片的时候，除了普通图层支持的 ",paraId:1,tocIndex:0},{value:"options",paraId:1,tocIndex:0},{value:" 参数之外，还需要需要我们提前设置矢量数据相关的参数。",paraId:1,tocIndex:0},{value:"featureId",paraId:2,tocIndex:0},{value:": string\n",paraId:2,tocIndex:0},{value:"用于可以自定义指定。用于指定瓦片的拾取高亮。",paraId:3,tocIndex:0},{value:"sourceLayer",paraId:2,tocIndex:0},{value:": string\n",paraId:2,tocIndex:0},{value:"用于必须传入，且要在返回的矢量数据中存在，指定绘制矢量数据中那一图层数据。",paraId:4,tocIndex:0},{value:"const layer = new RasterLayer({\n  featureId: 'id',\n  sourceLayer: 'water',\n});\n",paraId:5,tocIndex:0},{value:"瓦片图层的掩模使用和普通的图层一样，同样在 ",paraId:6,tocIndex:1},{value:"options",paraId:6,tocIndex:1},{value:" 中设置 ",paraId:6,tocIndex:1},{value:"mask、maskfence",paraId:6,tocIndex:1},{value:" 参数即可，不过矢量瓦片图层暂时不支持设置掩模。",paraId:6,tocIndex:1},{value:"fetch('https://gw.alipayobjects.com/os/bmw-prod/fccd80c0-2611-49f9-9a9f-e2a4dd12226f.json')\n  .then((res) => res.json())\n  .then((maskData) => {\n    const layer = new RasterLayer({\n      mask: true,\n      maskfence: maskData,\n    });\n\n    const tileSource = new Source(\n      'https://ganos.oss-cn-hangzhou.aliyuncs.com/m2/l7/tiff_jx/{z}/{x}/{y}.tiff',\n      {\n        parser: {\n          type: 'rasterTile',\n          dataType: 'arraybuffer',\n          tileSize: 256,\n          maxZoom: 13.1,\n          format: async (data) => {\n            const tiff = await GeoTIFF.fromArrayBuffer(data);\n            const image = await tiff.getImage();\n            const width = image.getWidth();\n            const height = image.getHeight();\n            const values = await image.readRasters();\n            return { rasterData: values[0], width, height };\n          },\n        },\n      },\n    );\n    layer.source(tileSource).style({\n      domain: [0.001, 11.001],\n      clampLow: false,\n      rampColors: {\n        colors: colorList,\n        positions,\n      },\n    });\n    scene.addLayer(layer);\n  });\n",paraId:7,tocIndex:1},{value:"在有些场景下，尤其是是矢量瓦片地图的场景，同一份瓦片数据会同时包含多图层的数据，此时我们需要让多图层复用同一个 ",paraId:8,tocIndex:2},{value:"source",paraId:8,tocIndex:2},{value:" 对象。如下图所示，我们使用同一份数据绘制省市的面、边界和名称，此时我们就应该复用 ",paraId:8,tocIndex:2},{value:"source",paraId:8,tocIndex:2},{value:" 对象。",paraId:8,tocIndex:2},{value:"  const tileSource = new Source(\n    'http://localhost:3000/file.mbtiles/{z}/{x}/{y}.pbf',\n    {\n      parser: {\n        type: 'mvt',\n        tileSize: 256,\n        zoomOffset: 0,\n        maxZoom: 9,\n        extent: [-180, -85.051129, 179, 85.051129],\n      },\n    });\n  const option = {\n    featureId: 'NAME_CHN',\n    sourceLayer: 'city'\n  }\n  const linelayer = new LineLayer(option)\n    .source(tileSource)\n    .color('#f00')\n    .size(1)\n    .style({\n      opacity: 0.5,\n    });\n  this.scene.addLayer(linelayer);\n\n  const polygonlayer = new PolygonLayer(option)\n    .source(tileSource)\n    .color('citycode', (v: string) => {\n        return getRandomColor(v);\n      }\n    })\n    .style({\n      opacity: 0.4,\n    })\n    .select(true);\n  this.scene.addLayer(polygonlayer);\n\n  const pointlayer = new PointLayer(option)\n    .source(tileSource)\n    .shape('NAME_CHN', 'text')\n    .color('#f00')\n    .size(12)\n    .style({\n      stroke: '#fff',\n      strokeWidth: 2,\n    });\n\n  this.scene.addLayer(pointlayer);\n",paraId:9,tocIndex:2},{value:"在使用上，瓦片图层绑定事件的操作和普通图层事件保持一致，但是在事件的返回参数中，瓦片图层对分布的数据进行合并操作，以求获取到当前图层的完整数据。",paraId:10,tocIndex:3},{value:"layer.on('click', e => {...})；\n",paraId:11,tocIndex:3}]}}]);